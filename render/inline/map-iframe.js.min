var pageUrl=null;var mapDiv=null;var map=null;var infoWindow=null;function initializeMap(){pageUrl=document.referrer.split("#",1)[0];var b={mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:false};mapDiv=document.getElementById("map-div");map=new google.maps.Map(mapDiv,b);infoWindow=new google.maps.InfoWindow();google.maps.event.addListenerOnce(map,"idle",function(){mapDiv.className="loaded"});var e=new google.maps.LatLngBounds();for(var c=0;c<points.length;c++){var f=points[c];f.latLong=new google.maps.LatLng(f.latLong[0],f.latLong[1]);e.extend(f.latLong);var d=String.fromCharCode(65+c);var a={position:f.latLong,title:f.name,icon:"https://chart.googleapis.com/chart?chst=d_map_pin_letter&chld="+d+"|8cf|000",map:map};f.marker=new google.maps.Marker(a);google.maps.event.addListener(f.marker,"click",selectPoint.bind(null,f.id,false))}map.fitBounds(e)}function selectPoint(h,c){var b=null;for(var e=0;e<points.length;++e){if(points[e].id==h){b=points[e];break}}if(!b){console.log("Unable to find point with ID "+h);return}var d=document.createElement("a");var g=function(){window.top.location=pageUrl+"#"+h};d.appendChild(document.createTextNode(b.name));d.className="location";d.addEventListener("click",g,false);infoWindow.setContent(d);infoWindow.open(map,b.marker);if(c){map.setCenter(b.latLong);mapDiv.scrollIntoView(true)}}google.maps.event.addDomListener(window,"load",initializeMap);window.addEventListener("message",function(a){selectPoint(a.data.id,true)},false);