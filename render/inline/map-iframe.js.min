var pageUrl=null,mapDiv=null,map=null,infoWindow=null;function initializeMap(){pageUrl=document.referrer.split('#',1)[0];var s={mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1},n,t,e,o,i;mapDiv=document.getElementById('map-div'),map=new google.maps.Map(mapDiv,s),infoWindow=new google.maps.InfoWindow,google.maps.event.addListenerOnce(map,'idle',function(){mapDiv.className='loaded'}),n=new google.maps.LatLngBounds;for(t=0;t<points.length;t++)e=points[t],e.latLong=new google.maps.LatLng(e.latLong[0],e.latLong[1]),n.extend(e.latLong),o=String.fromCharCode(65+t),i={position:e.latLong,title:e.name,icon:'https://chart.googleapis.com/chart?chst=d_map_pin_letter&chld='+o+'|8cf|000',map},e.marker=new google.maps.Marker(i),google.maps.event.addListener(e.marker,'click',selectPoint.bind(null,e.id,!1));map.fitBounds(n)}function selectPoint(s,o){for(var e=null,n,i,t=0;t<points.length;++t)if(points[t].id==s){e=points[t];break}if(!e){console.log('Unable to find point with ID '+s);return}n=document.createElement('a'),i=function(){window.top.location=pageUrl+'#'+s},n.appendChild(document.createTextNode(e.name)),n.className='location',n.addEventListener('click',i,!1),infoWindow.setContent(n),infoWindow.open(map,e.marker),o&&(map.setCenter(e.latLong),mapDiv.scrollIntoView(!0))}google.maps.event.addDomListener(window,'load',initializeMap),window.addEventListener('message',function(e){selectPoint(e.data.id,!0)},!1)